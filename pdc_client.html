<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3. PDC Client &mdash; PDC 0.1.0-1.45.gd6bfac0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0-1.45.gd6bfac0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="PDC 0.1.0-1.45.gd6bfac0 documentation" href="index.html" />
    <link rel="next" title="4. Setup development environment" href="development.html" />
    <link rel="prev" title="2. Bulk operations" href="bulk_operations.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="development.html" title="4. Setup development environment"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="bulk_operations.html" title="2. Bulk operations"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">PDC 0.1.0-1.45.gd6bfac0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="pdc-client">
<span id="id1"></span><h1>3. PDC Client<a class="headerlink" href="#pdc-client" title="Permalink to this headline">¶</a></h1>
<p>PDC Client is a shell CLI that make it easier to access data from PDC servers.</p>
<div class="section" id="installation">
<h2>3.1. Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>You can obtain the client from the same repository where PDC server is.</p>
</div>
<div class="section" id="configuration">
<h2>3.2. Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>The client can read server connection details from a configuration file. The
configuration file should be located in <code class="docutils literal"><span class="pre">/etc/pdc/client_config.json</span></code> or in
<code class="docutils literal"><span class="pre">~/.config/pdc/client_config.json</span></code>. If both files are present, the system one
is loaded first and the user configuration is applied on top of it (to add
other options or overwrite existing ones).</p>
<p>The configuration file should contain a JSON object, which maps server name to
JSON object with details. The name is an arbitrary string used at client run
time to identify which server you want to connect to.</p>
<p>The details of a single server must contain at least one key: <code class="docutils literal"><span class="pre">host</span></code> which
specifies the URL to the API root (e.g. <code class="docutils literal"><span class="pre">http:://localhost:8000/rest_api/v1/</span></code>
for local instance).</p>
<p>Other possible keys are:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">token</span></code></dt>
<dd>If specified, this token will be used for authentication. The client will
not try to obtain any token from the server.</dd>
<dt><code class="docutils literal"><span class="pre">insecure</span></code></dt>
<dd>If set to <code class="docutils literal"><span class="pre">true</span></code>, server certificate will not be validated.</dd>
<dt><code class="docutils literal"><span class="pre">develop</span></code></dt>
<dd>When set to <code class="docutils literal"><span class="pre">true</span></code>, the client will not use any authentication at all,
not requesting a token nor sending any token with the requests. This is
only useful for working with servers which don&#8217;t require authentication.</dd>
</dl>
<div class="section" id="example-system-configuration">
<h3>3.2.1. Example system configuration<a class="headerlink" href="#example-system-configuration" title="Permalink to this headline">¶</a></h3>
<p>This config defines connection to development server running on localhost and a
production server.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;local&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;host&quot;</span><span class="p">:</span> <span class="s">&quot;http://localhost:8000/rest_api/v1/&quot;</span><span class="p">,</span>
        <span class="s">&quot;develop&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s">&quot;insecure&quot;</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">},</span>
    <span class="s">&quot;prod&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;host&quot;</span><span class="p">:</span> <span class="s">&quot;https://pdc.example.com/rest_api/v1/&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="usage">
<h2>3.3. Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>The client package contains two separate clients. Both contain extensive
built-in help. Just run the executable with <code class="docutils literal"><span class="pre">-h</span></code> or <code class="docutils literal"><span class="pre">--help</span></code> argument.</p>
<div class="section" id="id2">
<h3>3.3.1. <code class="docutils literal"><span class="pre">pdc_client</span></code><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>This is a very simple client. Essentially this is just a little more convenient
than using <code class="docutils literal"><span class="pre">curl</span></code> manually. Each invocation of this client obtains a token
and then performs a single request.</p>
<p>This client is not meant for direct usage, but just as a helper for integrating
with PDC from languages where it might be easier than performing the network
requests manually.</p>
</div>
<div class="section" id="pdc">
<h3>3.3.2. <code class="docutils literal"><span class="pre">pdc</span></code><a class="headerlink" href="#pdc" title="Permalink to this headline">¶</a></h3>
<p>This is much more user friendly user interface. A single invocation can perform
multiple requests depending on what subcommand you used.</p>
</div>
</div>
<div class="section" id="python-api">
<h2>3.4. Python API<a class="headerlink" href="#python-api" title="Permalink to this headline">¶</a></h2>
<p>When writing a client code interfacing with PDC server, you might find
<code class="docutils literal"><span class="pre">PDCClient</span></code> handy. It provides access to the configuration defined above and
automates obtaining authorization token.</p>
<p>To use this module, you will need to install its dependencies. These include</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://docs.python-requests.org/en/latest/">requests</a></li>
<li><a class="reference external" href="https://github.com/requests/requests-kerberos/">requests-kerberos</a></li>
<li><a class="reference external" href="http://beanbag.readthedocs.org/en/latest/">beanbag</a></li>
</ul>
</div></blockquote>
<dl class="class">
<dt id="pdc_client.PDCClient">
<em class="property">class </em><code class="descclassname">pdc_client.</code><code class="descname">PDCClient</code><span class="sig-paren">(</span><em>server</em><span class="sig-paren">)</span><a class="headerlink" href="#pdc_client.PDCClient" title="Permalink to this definition">¶</a></dt>
<dd><p>BeanBag wrapper specialized for PDC access.</p>
<p>This class wraps general BeanBag.v1 objects, but provides easy-to-use
interface that can use configuration files for specifying server
connections. The authentication token is automatically retrieved (if
needed).</p>
<dl class="method">
<dt id="pdc_client.PDCClient.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>server</em><span class="sig-paren">)</span><a class="headerlink" href="#pdc_client.PDCClient.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create new client instance.</p>
<p>Once the class is instantiated, use it as you would use a regular
BeanBag object. Please see its documentation to see how to use this
class to perform requests.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>server</strong> (<em>string</em>) &#8211; server API url or server name from configuration</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pdc_client.PDCClient.set_comment">
<code class="descname">set_comment</code><span class="sig-paren">(</span><em>comment</em><span class="sig-paren">)</span><a class="headerlink" href="#pdc_client.PDCClient.set_comment" title="Permalink to this definition">¶</a></dt>
<dd><p>Set PDC Change comment to be stored on the server.</p>
<p>Once you set the comment, it will be sent in all subsequent requests.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>comment</strong> (<em>string</em>) &#8211; what comment to send to the server</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<p>When working with paginated responses, there is a utility function to simplify
that. From client code it is iterating single object. Behind the scenes it will
download the first page, once all results from that page are exhausted, it will
get another page until everything is processed.</p>
<dl class="function">
<dt id="pdc_client.get_paged">
<code class="descclassname">pdc_client.</code><code class="descname">get_paged</code><span class="sig-paren">(</span><em>res</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pdc_client.get_paged" title="Permalink to this definition">¶</a></dt>
<dd><p>This call is equivalent to <code class="docutils literal"><span class="pre">res(**kwargs)</span></code>, only it retrieves all pages
and returns the results joined into a single iterable. The advantage over
retrieving everything at once is that the result can be consumed
immediately.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>res</strong> &#8211; what resource to connect to</li>
<li><strong>kwargs</strong> &#8211; filters to be used</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Example: Iterate over all active releases</span>
<span class="k">for</span> <span class="n">release</span> <span class="ow">in</span> <span class="n">get_paged</span><span class="p">(</span><span class="n">client</span><span class="p">[</span><span class="s">&#39;releases&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="known-issues">
<h2>3.5. Known Issues<a class="headerlink" href="#known-issues" title="Permalink to this headline">¶</a></h2>
<div class="section" id="kerberos">
<h3>3.5.1. Kerberos<a class="headerlink" href="#kerberos" title="Permalink to this headline">¶</a></h3>
<p>Under enterprise network, <a class="reference external" href="http://web.mit.edu/Kerberos/www/krb5-latest/doc/admin/princ_dns.html#reverse-dns-mismatches">Reverse DNS mismatches</a>
may cause problems authenticating with Kerberos.</p>
<p>If you can successfully run <code class="docutils literal"><span class="pre">kinit</span></code> but not authenticate yourself to PDC
servers, check <code class="docutils literal"><span class="pre">/etc/krb5.conf</span></code> and make sure that <code class="docutils literal"><span class="pre">rdns</span></code> is set to false
in <code class="docutils literal"><span class="pre">libdefaults</span></code> section.</p>
<div class="highlight-python"><div class="highlight"><pre>[libdefaults]
    rdns = false
</pre></div>
</div>
</div>
</div>
<div class="section" id="for-developers">
<h2>3.6. For Developers<a class="headerlink" href="#for-developers" title="Permalink to this headline">¶</a></h2>
<div class="section" id="instalation-details">
<h3>3.6.1. Instalation details<a class="headerlink" href="#instalation-details" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">yum repository</p>
<p>If you have installed PDC Server by some yum repository, PDC Client is in
the same repository that you used.</p>
<p>So to install PDC Client, just need to</p>
<div class="highlight-python"><div class="highlight"><pre>$ sudo yum install pdc-client -y
</pre></div>
</div>
</li>
<li><p class="first">build from source</p>
<p>If you have got the code and setup your development environment (see
<a class="reference internal" href="development.html#development"><span>Setup development environment</span></a>), then you could build from source and install the
client and it&#8217;s dependency package python-pdc</p>
<div class="highlight-python"><div class="highlight"><pre>$ git checkout `{release-tag}`
$ make rpm
$ sudo yum install dist/noarch/python-pdc*.noarch.rpm dist/noarch/pdc-client*.noarch.rpm
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="general">
<h3>3.6.2. General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h3>
<p>The PDC Client (package name: pdc_client) is mainly build up with Python
<cite>argparse</cite> module and PDC&#8217;s Python module <cite>pdc_client</cite>.</p>
<p>It is powered by <a class="reference external" href="http://beanbag.readthedocs.org/en/latest/">BeanBag</a>, a simple module
that lets you access REST APIs in an easy way.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3. PDC Client</a><ul>
<li><a class="reference internal" href="#installation">3.1. Installation</a></li>
<li><a class="reference internal" href="#configuration">3.2. Configuration</a><ul>
<li><a class="reference internal" href="#example-system-configuration">3.2.1. Example system configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage">3.3. Usage</a><ul>
<li><a class="reference internal" href="#id2">3.3.1. <code class="docutils literal"><span class="pre">pdc_client</span></code></a></li>
<li><a class="reference internal" href="#pdc">3.3.2. <code class="docutils literal"><span class="pre">pdc</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#python-api">3.4. Python API</a></li>
<li><a class="reference internal" href="#known-issues">3.5. Known Issues</a><ul>
<li><a class="reference internal" href="#kerberos">3.5.1. Kerberos</a></li>
</ul>
</li>
<li><a class="reference internal" href="#for-developers">3.6. For Developers</a><ul>
<li><a class="reference internal" href="#instalation-details">3.6.1. Instalation details</a></li>
<li><a class="reference internal" href="#general">3.6.2. General</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="bulk_operations.html"
                        title="previous chapter">2. Bulk operations</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="development.html"
                        title="next chapter">4. Setup development environment</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pdc_client.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="development.html" title="4. Setup development environment"
             >next</a> |</li>
        <li class="right" >
          <a href="bulk_operations.html" title="2. Bulk operations"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">PDC 0.1.0-1.45.gd6bfac0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014-2015, PDC Devel Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>